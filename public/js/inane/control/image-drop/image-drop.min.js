(function(window,I){const VERSION='0.9.1';_icroot.iHelper.importModule('iFile');const Config={ext:['jpg','png','svg'],sizeLimitKB:500,logger:console,ui:{hover:'highlight'},view:{zone:'.image-drop-zone',image:'.image-drop-image',file:'.image-drop-file',},};function createEvent(namespace,action,detail={}){detail.namespace=namespace;detail.action=action;return new CustomEvent(namespace+':'+action,{bubbles:false,detail});}
const ImageDrop=function(imageDrop,options={}){this.VERSION=VERSION;Object.assign(options,Config);const reader=new FileReader();const dropZone=imageDrop.classList.contains(options.view.zone.replace('.',''))?imageDrop:imageDrop.querySelector(options.view.zone)==null?imageDrop:imageDrop.querySelector(options.view.zone);const imgView=imageDrop.querySelector(options.view.image)||imageDrop.querySelector('img');const inFile=imageDrop.querySelector(options.view.file)||imageDrop.querySelector('input[type="file"]');this.image=imgView;dropZone.addEventListener('dragover',function(event){event.preventDefault();event.stopPropagation();},true);dropZone.addEventListener('dragenter',function(event){event.preventDefault();event.stopPropagation();this.classList.add(options.ui.hover);},true);dropZone.addEventListener('dragleave',function(event){event.preventDefault();event.stopPropagation();this.classList.remove(options.ui.hover);},true);dropZone.addEventListener('drop',function(event){event.preventDefault();event.stopPropagation();inFile.files=event.dataTransfer.files;this.classList.remove(options.ui.hover);},true);dropZone.addEventListener('click',function(event){options.logger.debug('dropZone','click');event.stopPropagation();inFile.click();},true);reader.addEventListener('load',function(event){event.stopPropagation();imgView.src=reader.result;},true);inFile.addEventListener('change',function(event){event.stopPropagation();if(this.files&&this.files[0]){let file=new _icroot.iFile(this.files[0]);if(!options.ext.includes(file.ext))return console.log('Invalid ext. use: '+options.ext.join(', '));if(file.KB>options.sizeLimitKB)return console.log('File size to large. Limit: '+options.sizeLimitKB);reader.readAsDataURL(file.file);}},true);imgView.addEventListener('load',function(event){options.logger.debug('ImageDrop:Image:Load');},true);}
ImageDrop.VERSION=VERSION;ImageDrop.defaults=function(defaults){Object.assign(Config,defaults);}
window.ImageDrop=ImageDrop;}(window,I));